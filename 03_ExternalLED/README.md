# 03 点亮外部 LED

点亮内置 LED 不过瘾，咱们多安装几个 LED 轮询点亮吧～

在本示例中，我们将了解：

- 循环语句：[`for`](https://www.arduino.cc/reference/en/language/structure/control-structure/for/)；
- 条件语句：[`if`](https://www.arduino.cc/reference/en/language/structure/control-structure/if/)。


## 基本思路

给定一个轮询变量储存 LED 的引脚号，每隔一定时间刷新。除了该轮询变量引脚输出为高电平外，其他均为低电平。以此实现 LED 轮流点亮。


## 算法实现

### 硬件布局

将外部 LED 的正极（引线长的那一头）接到 Arduino 数字输出口，负极通过 220 Ω 电阻接地，如下图所示。

<div align=center>
    <img src=./ExternalLED.svg width=300 />
</div>

**注意**：本次示例请将 LED 接入连续的三个数字口以方便轮询。例如上图三个 LED 分别接入 7、8、9 号端口，可以将 7 作为引脚基准（`pinBase`），0、1、2 为 LED 的编号。记需要点亮（turn on）的 LED 编号为 `turnLED` ，则其引脚为 `pinBase + turnLED`。


### 引脚设置

程序开始之前，声明了一些变量并赋值，分别是：

- 引脚号的基准 `pinBase = 7`，表示第一个端口为 7 号；
- 使用引脚的数量 `pinNum = 3`，即连续使用 3 个端口，结合 `pinBase` 可知使用了 7、8、9 号端口；
- 点亮的 LED 编号 `turnLED = 0`，与该编号对应的 LED 将被点亮。


> 我这里写的有点随意了，“端口”和“引脚”实际上想表达同一个意思。唔……相信聪明的你应该能明白，我就偷懒不改了。

在 `setup()` 函数内，将 LED 正极对应的引脚设置为输出端。在本例使用连续编号端口情况下，很容易使用 `for` 循环来实现。

`for` 循环的基本用法为：

```arduino
for ( 初始化; 循环条件; 增量 ) {
    循环内容;
}
```

在初始化位置使用 `int i = 0` 新建一个临时变量用于循环，并幅值为 `0`，用于表示 LED 的编号；循环的条件是当前的编号 `i` 在 LED 对应的端口总数（`pinNum`）范围内；最后将增量那里设置为 `i++`，这是 C/C++ 的语法糖，作用是将整数 `+1` ，这里就意味着每循环运行一次代码， LED 的编号增加 1，表示将对下一个 LED 重复相同的操作。循环内容自然是将编号为 `i` 的端口通过 `pinMode` 设置为 `OUTPUT`。


### 循环点亮

在 `loop()` 函数体内，我们将循环将 LED 点亮，由于 `loop()` 本身就是一个大循环，我决定在每个大循环内点亮一个 LED，因此这个函数体内的第一行就是将 `turnLED` 对应的 LED 点亮。

其他的 LED 可能在上一步被点亮，因此需要确保其熄灭，再次使用 `for` 构成小循环，将编号不是 `turnLED` 的 LED 熄灭。这时需要使用 `if` 进行判断，基本语法为：

```arduino
if (条件) {
    代码
}
```

其中条件通常为逻辑判断，为真时则执行花括号内的代码。常用的判断包括：相等 `==` ，不相等 `!=` ，大于 `>` ，大于等于 `>=`，小于 `<` ，小于等于 `<=`，且 `&&` ，或 `||` ，非 `!` 。

小循环 `for` 控制各个 LED 的状态后，将 `turnLED += 1` (这也是语法糖，相当于 `turnLED = turnLED + 1`) ，用于下一个大循环点亮下一个 LED。但是应当注意 `turnLED` 的编号不能超过 LED 的总数。这里 LED 从 0 开始编号，总共有 3 个，因此 `turnLED` 达到 3 后将其重置为 0。

当然，最后用 `delay()` 控制大循环的速度就可以了。试试吧～


> 哟西，又写完了一个折腾笔记。